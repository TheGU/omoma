{% load i18n %}
{% spaceless %}
{% if saved %}
    <div id="accountssaved" class="ui-state-highlight ui-corner-all" style="padding: 0 .7em;">
        <p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;"></span>{% trans "Your accounts have been saved." %}</p>
    </div>
{% endif %}
{% if newcreated %}
    <div id="accountssaved" class="ui-state-highlight ui-corner-all" style="padding: 0 .7em;">
        <p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;"></span>{% trans "New account created." %}</p>
    </div>
{% endif %}
{% if deleted %}
    <div id="accountssaved" class="ui-state-highlight ui-corner-all" style="padding: 0 .7em;">
        <p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;"></span>{% trans "Account has been deleted." %}</p>
    </div>
{% endif %}
<form id="accountsform" action="{% url configureaccounts %}" method="POST">
    {% csrf_token %}
    {{ formset.management_form }}
    <table>
        <tr>
            <th></th>
            <th>{% trans "Name" %}</th>
            <th>{% trans "Start balance" %}</th>
            <th>{% trans "Currency" %}</th>
        </tr>
        {% for form in formset %}
            {{ form.id }}
            <tr>
                <td>
                    <span id="deleteaccount{{ form.instance.id }}" class="button deleteaccount">
                        <span class="jquery-icon jquery-icon-4b1c6c-cd0a0a ui-icon-closethick"></span>
                    </span>
                </td>
                <td>{{ form.name }}</td>
                <td>{{ form.start_balance }}</td>
                <td>{{ form.currency }}</td>
            </tr>
        {% endfor %}
    </table>
    <input type="submit" value="{% trans "Save modifications" %}" />
    <button type="button" id="newaccount">{% trans "Create new account" %}</button>
</form>
<script>
    $('button#newaccount').click(function (event) {
        opendialog("newaccount", gettext("Create new account"));
        event.preventDefault();
    });
    $('span.deleteaccount').click(function (event) {
        opendialog($(this).attr('id'), gettext("Delete account"));
        event.preventDefault();

    });
    updateinputelements();
    dialogform('accounts', 'accountssaved');</script>
{% endspaceless %}
